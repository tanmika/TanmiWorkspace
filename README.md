# TanmiWorkspace

é¢å‘ AI ç¼–ç¨‹åŠ©æ‰‹çš„åˆ†å½¢ä»»åŠ¡è·Ÿè¸ªç³»ç»Ÿï¼Œé€šè¿‡ MCP åè®®æä¾›ç»“æ„åŒ–çš„ä»»åŠ¡ç®¡ç†èƒ½åŠ›ã€‚

## æ ¸å¿ƒç‰¹æ€§

- **åˆ†å½¢ä»»åŠ¡ç»“æ„**ï¼šæ”¯æŒä»»åŠ¡çš„æ— é™å±‚çº§åµŒå¥—ï¼Œä»»æ„æ­¥éª¤å¯å‡çº§ä¸ºç‹¬ç«‹å­ä»»åŠ¡
- **èšç„¦ä¸Šä¸‹æ–‡**ï¼šæ‰§è¡Œç‰¹å®šèŠ‚ç‚¹æ—¶è‡ªåŠ¨è¿‡æ»¤æ— å…³ä¿¡æ¯ï¼Œé¿å…ä¸Šä¸‹æ–‡æ±¡æŸ“
- **è¿‡ç¨‹å¯è¿½æº¯**ï¼šå®Œæ•´æ“ä½œå†å²å’Œè¯•é”™è·¯å¾„ï¼Œæ”¯æŒå›æº¯å¤ç›˜
- **çŠ¶æ€ç®¡ç†**ï¼špending â†’ implementing â†’ validating â†’ completed/failed
- **é¡¹ç›®çº§å­˜å‚¨éš”ç¦»**ï¼šworkspaceId é€šè¿‡å…¨å±€ç´¢å¼•æ˜ å°„åˆ° projectRootï¼Œæ•°æ®å†™å…¥é¡¹ç›®å†… `.tanmi-workspace`
- **AI å¼•å¯¼**ï¼šå†…ç½®ä½¿ç”¨æŒ‡å—å’Œè¯æœ¯æ¨¡æ¿ï¼Œå¯å¼•å¯¼ä¸ç†Ÿæ‚‰çš„ç”¨æˆ·

---

## Web å®¢æˆ·ç«¯

å‰ç«¯å•é¡µåº”ç”¨æ‰˜ç®¡äº `web/` ç›®å½•ï¼Œä¸º TanmiWorkspace æä¾›å¯è§†åŒ–äº¤äº’ç•Œé¢ã€‚

### æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vue 3 | ^3.5 | å“åº”å¼ UI æ¡†æ¶ |
| TypeScript | ~5.9 | ç±»å‹å®‰å…¨ |
| Vite | ^7.2 | æ„å»ºå·¥å…·ä¸å¼€å‘æœåŠ¡å™¨ |
| Pinia | ^3.0 | çŠ¶æ€ç®¡ç† |
| Element Plus | ^2.11 | UI ç»„ä»¶åº“ |
| Axios | ^1.13 | HTTP å®¢æˆ·ç«¯ |
| Vue Router | ^4.6 | è·¯ç”±ç®¡ç† |

### é¡µé¢ç»“æ„

#### é¦–é¡µï¼ˆHomeViewï¼‰

å·¥ä½œåŒºç®¡ç†é¢æ¿ï¼Œæä¾›ï¼š

- **å·¥ä½œåŒºåˆ—è¡¨**ï¼šå¡ç‰‡å¼å±•ç¤ºæ‰€æœ‰å·¥ä½œåŒºï¼ŒåŒ…å«åç§°ã€çŠ¶æ€ã€åˆ›å»º/æ›´æ–°æ—¶é—´
- **çŠ¶æ€ç­›é€‰**ï¼šå…¨éƒ¨ / æ´»è·ƒ / å·²å½’æ¡£ ä¸‰ç§è¿‡æ»¤æ¨¡å¼
- **æ–°å»ºå·¥ä½œåŒº**ï¼šå¼¹çª—è¡¨å•ï¼Œå¡«å†™åç§°å’Œç›®æ ‡å³å¯åˆ›å»º
- **å¿«æ·æ“ä½œ**ï¼šè¿›å…¥è¯¦æƒ…ã€åˆ é™¤ï¼ˆå¸¦ç¡®è®¤ï¼‰

#### å·¥ä½œåŒºè¯¦æƒ…ï¼ˆWorkspaceViewï¼‰

åŒæ å¸ƒå±€çš„ä»»åŠ¡ç®¡ç†ç•Œé¢ï¼š

**å·¦ä¾§ - èŠ‚ç‚¹æ ‘ï¼ˆNodeTreeï¼‰**
- æ ‘å½¢ç»“æ„å±•ç¤ºåˆ†å½¢ä»»åŠ¡å±‚çº§
- çŠ¶æ€å›¾æ ‡ï¼ˆemojiï¼‰å®æ—¶åæ˜ èŠ‚ç‚¹çŠ¶æ€
- ç„¦ç‚¹èŠ‚ç‚¹é«˜äº®æ ‡è¯†ï¼ˆâ—„ æŒ‡ç¤ºå™¨ï¼‰
- ç‚¹å‡»èŠ‚ç‚¹åˆ‡æ¢æŸ¥çœ‹è¯¦æƒ…

**å³ä¾§ - èŠ‚ç‚¹è¯¦æƒ…ï¼ˆNodeDetailï¼‰**
- æ ‡é¢˜ä¸çŠ¶æ€å¾½ç« 
- æ“ä½œæŒ‰é’®ç»„ï¼šæ ¹æ®å½“å‰çŠ¶æ€åŠ¨æ€æ˜¾ç¤ºå¯ç”¨è½¬æ¢
  - pending â†’ å¼€å§‹æ‰§è¡Œ
  - implementing â†’ æäº¤éªŒè¯ / ç›´æ¥å®Œæˆ / åˆ†è£‚å­ä»»åŠ¡
  - validating â†’ éªŒè¯é€šè¿‡ / éªŒè¯å¤±è´¥
  - failed â†’ é‡è¯•
- éœ€æ±‚æè¿°å¡ç‰‡
- ç»“è®ºå¡ç‰‡ï¼ˆå·²å®ŒæˆèŠ‚ç‚¹ï¼‰
- å½“å‰é—®é¢˜å¡ç‰‡ï¼ˆé«˜äº®è­¦ç¤ºï¼‰
- æ‰§è¡Œæ—¥å¿—æ—¶é—´çº¿ï¼ˆLogTimelineï¼‰ï¼šæŒ‰æ—¶é—´çº¿å±•ç¤º AI/Human æ“ä½œè®°å½•
- å­èŠ‚ç‚¹ç»“è®ºæ±‡æ€»

### ç»„ä»¶ä¸€è§ˆ

```
web/src/
â”œâ”€â”€ views/
â”‚   â”œâ”€â”€ HomeView.vue        # å·¥ä½œåŒºåˆ—è¡¨é¡µ
â”‚   â”œâ”€â”€ WorkspaceView.vue   # å·¥ä½œåŒºè¯¦æƒ…é¡µ
â”‚   â””â”€â”€ NotFoundView.vue    # 404 é¡µé¢
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ node/
â”‚   â”‚   â”œâ”€â”€ NodeTree.vue    # åˆ†å½¢ä»»åŠ¡æ ‘
â”‚   â”‚   â””â”€â”€ NodeDetail.vue  # èŠ‚ç‚¹è¯¦æƒ…é¢æ¿
â”‚   â”œâ”€â”€ log/
â”‚   â”‚   â””â”€â”€ LogTimeline.vue # æ—¥å¿—æ—¶é—´çº¿
â”‚   â””â”€â”€ common/
â”‚       â””â”€â”€ StatusIcon.vue  # çŠ¶æ€å›¾æ ‡
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ workspace.ts        # å·¥ä½œåŒºçŠ¶æ€
â”‚   â”œâ”€â”€ node.ts             # èŠ‚ç‚¹çŠ¶æ€
â”‚   â””â”€â”€ index.ts            # Store å¯¼å‡º
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ client.ts           # Axios å®ä¾‹
â”‚   â”œâ”€â”€ workspace.ts        # å·¥ä½œåŒº API
â”‚   â”œâ”€â”€ node.ts             # èŠ‚ç‚¹ API
â”‚   â”œâ”€â”€ context.ts          # ä¸Šä¸‹æ–‡ API
â”‚   â”œâ”€â”€ log.ts              # æ—¥å¿— API
â”‚   â””â”€â”€ index.ts            # API å¯¼å‡º
â”œâ”€â”€ types/
â”‚   â””â”€â”€ index.ts            # ç±»å‹å®šä¹‰ä¸çŠ¶æ€é…ç½®
â”œâ”€â”€ router/
â”‚   â””â”€â”€ index.ts            # è·¯ç”±é…ç½®
â”œâ”€â”€ main.ts                 # å…¥å£æ–‡ä»¶
â””â”€â”€ App.vue                 # æ ¹ç»„ä»¶
```

### çŠ¶æ€é…ç½®

èŠ‚ç‚¹çŠ¶æ€é€šè¿‡é¢œè‰²å’Œ emoji å¯è§†åŒ–åŒºåˆ†ï¼š

| çŠ¶æ€ | é¢œè‰² | å›¾æ ‡ | è¯´æ˜ |
|------|------|------|------|
| pending | #909399 | âšª | å¾…æ‰§è¡Œ |
| implementing | #409EFF | ğŸ”µ | æ‰§è¡Œä¸­ |
| validating | #E6A23C | ğŸŸ¡ | éªŒè¯ä¸­ |
| completed | #67C23A | âœ… | å·²å®Œæˆ |
| failed | #F56C6C | âŒ | å¤±è´¥ |

### è¿è¡Œä¸å¼€å‘

```bash
cd web
npm install
npm run dev         # å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­æ›´æ–°ï¼‰
npm run build       # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run preview     # é¢„è§ˆæ„å»ºäº§ç‰©
```

### API é€šä¿¡

å‰ç«¯é€šè¿‡ `/api` å‰ç¼€ä¸åç«¯ HTTP æœåŠ¡é€šä¿¡ï¼ŒAxios å®ä¾‹é…ç½®ï¼š

- åŸºç¡€è·¯å¾„ï¼š`/api`
- è¶…æ—¶æ—¶é—´ï¼š10 ç§’
- ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼šæ‹¦æˆªå™¨æå–é”™è¯¯ä¿¡æ¯

---

## ç³»ç»Ÿè¦æ±‚

- **Node.js >= 20.0.0**ï¼ˆå¿…é¡»ï¼‰

### å®‰è£… Node 20

```bash
# æ–¹å¼ 1ï¼šä½¿ç”¨ nvmï¼ˆæ¨èï¼‰
nvm install 20
nvm use 20

# æ–¹å¼ 2ï¼šç›´æ¥ä¸‹è½½
# https://nodejs.org/ ä¸‹è½½ LTS ç‰ˆæœ¬
```

## å®‰è£…

```bash
npm install
npm run build
```

## é…ç½® MCP å®¢æˆ·ç«¯

### Claude Desktop / Cursor

```json
{
  "mcpServers": {
    "tanmi-workspace": {
      "command": "node",
      "args": ["/path/to/tanmi-workspace/dist/check-node-version.js"]
    }
  }
}
```

### å¦‚æœç³»ç»Ÿé»˜è®¤ Node ç‰ˆæœ¬ä½äº 20

éœ€è¦æŒ‡å®š Node 20 çš„å®Œæ•´è·¯å¾„ï¼š

```json
{
  "mcpServers": {
    "tanmi-workspace": {
      "command": "/path/to/node20/bin/node",
      "args": ["/path/to/tanmi-workspace/dist/check-node-version.js"]
    }
  }
}
```

**æŸ¥æ‰¾ Node 20 è·¯å¾„ï¼š**
```bash
# ä½¿ç”¨ nvm
nvm which 20
# è¾“å‡º: /Users/xxx/.nvm/versions/node/v20.x.x/bin/node

# æˆ–è€…æŸ¥çœ‹å·²å®‰è£…ä½ç½®
which node
```

## å¿«é€Ÿå¼€å§‹

```typescript
// 1. åˆ›å»ºå·¥ä½œåŒº
workspace_init({ name: "å®ç°ç™»å½•åŠŸèƒ½", goal: "æ·»åŠ ç”¨æˆ·åå¯†ç ç™»å½•", projectRoot: process.cwd() }) // projectRoot å¯é€‰ï¼Œé»˜è®¤å½“å‰ç›®å½•

// 2. åˆ›å»ºå­ä»»åŠ¡
node_create({ workspaceId: "ws-xxx", parentId: "root", title: "è®¾è®¡æ•°æ®åº“" })

// 3. å¼€å§‹æ‰§è¡Œ
node_transition({ workspaceId: "ws-xxx", nodeId: "node-xxx", action: "start" })

// 4. è®°å½•è¿‡ç¨‹
log_append({ workspaceId: "ws-xxx", nodeId: "node-xxx", operator: "AI", event: "åˆ›å»ºè¡¨ç»“æ„" })

// 5. å®Œæˆä»»åŠ¡
node_transition({ workspaceId: "ws-xxx", nodeId: "node-xxx", action: "complete", conclusion: "å®Œæˆ" })
```
> workspace_init ç°è¿”å›å®é™…çš„ `projectRoot`ï¼Œå¹¶å¯é€‰å¸¦å›å‰ç«¯ `webUrl` ä¾¿äºç›´æ¥æ‰“å¼€ Web ç•Œé¢ã€‚

## å·¥å…·åˆ—è¡¨ï¼ˆ19 ä¸ªï¼‰

### å·¥ä½œåŒº
| å·¥å…· | è¯´æ˜ |
|------|------|
| `workspace_init` | åˆ›å»ºå·¥ä½œåŒº |
| `workspace_list` | åˆ—å‡ºå·¥ä½œåŒº |
| `workspace_get` | è·å–è¯¦æƒ… |
| `workspace_delete` | åˆ é™¤å·¥ä½œåŒº |
| `workspace_status` | çŠ¶æ€æ¦‚è§ˆ |

### èŠ‚ç‚¹
| å·¥å…· | è¯´æ˜ |
|------|------|
| `node_create` | åˆ›å»ºå­ä»»åŠ¡ |
| `node_split` | åˆ†è£‚å­ä»»åŠ¡ |
| `node_get` | è·å–è¯¦æƒ… |
| `node_list` | åˆ—å‡ºèŠ‚ç‚¹æ ‘ |
| `node_update` | æ›´æ–°èŠ‚ç‚¹ |
| `node_delete` | åˆ é™¤èŠ‚ç‚¹ |

### çŠ¶æ€
| å·¥å…· | è¯´æ˜ |
|------|------|
| `node_transition` | çŠ¶æ€è½¬æ¢ï¼ˆstart/submit/complete/pass/fail/retryï¼‰ |

### ä¸Šä¸‹æ–‡
| å·¥å…· | è¯´æ˜ |
|------|------|
| `context_get` | è·å–èšç„¦ä¸Šä¸‹æ–‡ |
| `context_focus` | åˆ‡æ¢ç„¦ç‚¹ |
| `node_isolate` | è®¾ç½®éš”ç¦» |
| `node_reference` | ç®¡ç†å¼•ç”¨ |

### æ—¥å¿—
| å·¥å…· | è¯´æ˜ |
|------|------|
| `log_append` | è¿½åŠ æ—¥å¿— |
| `problem_update` | æ›´æ–°é—®é¢˜ |
| `problem_clear` | æ¸…é™¤é—®é¢˜ |

### å¸®åŠ©
| å·¥å…· | è¯´æ˜ |
|------|------|
| `tanmi_help` | è·å–ä½¿ç”¨æŒ‡å— |
| `tanmi_prompt` | è·å–è¯æœ¯æ¨¡æ¿ |

## AI ä½¿ç”¨æŒ‡å—

```typescript
// è·å–å®Œæ•´æŒ‡å—
tanmi_help({ topic: "all" })

// åœºæ™¯æŒ‡å¯¼
tanmi_help({ topic: "start" })    // å¼€å§‹æ–°ä»»åŠ¡
tanmi_help({ topic: "blocked" })  // ä»»åŠ¡å—é˜»
tanmi_help({ topic: "split" })    // åˆ†è£‚ä»»åŠ¡
tanmi_help({ topic: "guide" })    // å¼•å¯¼ç”¨æˆ·

// è¯æœ¯æ¨¡æ¿
tanmi_prompt({ template: "welcome" })
tanmi_prompt({ template: "confirm_workspace", params: { name: "ä»»åŠ¡å", goal: "ç›®æ ‡" } })
```

### å¸®åŠ©ä¸»é¢˜

| ä¸»é¢˜ | è¯´æ˜ |
|------|------|
| `overview` | ç³»ç»Ÿæ¦‚è¿° |
| `workflow` | æ ¸å¿ƒæµç¨‹ |
| `tools` | å·¥å…·é€ŸæŸ¥ |
| `start` | å¼€å§‹ä»»åŠ¡ |
| `resume` | ç»§ç»­ä»»åŠ¡ |
| `blocked` | ä»»åŠ¡å—é˜» |
| `split` | åˆ†è£‚ä»»åŠ¡ |
| `complete` | å®Œæˆä»»åŠ¡ |
| `progress` | æŸ¥çœ‹è¿›åº¦ |
| `guide` | å¼•å¯¼ç”¨æˆ· |

## æ•°æ®å­˜å‚¨

```
~/.tanmi-workspace/
â”œâ”€â”€ index.json                     # workspaceId â†’ projectRoot æ˜ å°„
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ [template-id].json

{projectRoot}/
â””â”€â”€ .tanmi-workspace/
    â””â”€â”€ [workspace-id]/
        â”œâ”€â”€ workspace.json         # å…ƒæ•°æ®ï¼ˆå« projectRootï¼‰
        â”œâ”€â”€ graph.json             # èŠ‚ç‚¹æ‹“æ‰‘
        â”œâ”€â”€ Workspace.md           # è§„åˆ™ã€æ–‡æ¡£ã€ç›®æ ‡
        â”œâ”€â”€ Log.md                 # å…¨å±€æ—¥å¿—
        â”œâ”€â”€ Problem.md             # å…¨å±€é—®é¢˜
        â””â”€â”€ nodes/[node-id]/
            â”œâ”€â”€ Info.md            # èŠ‚ç‚¹éœ€æ±‚ä¸å¼•ç”¨
            â”œâ”€â”€ Log.md             # èŠ‚ç‚¹æ—¥å¿—
            â””â”€â”€ Problem.md         # èŠ‚ç‚¹é—®é¢˜
```

## å¼€å‘

```bash
# ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰- åŒæ—¶å¯åŠ¨åç«¯ API + å‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run dev:all

# åˆ†åˆ«å¯åŠ¨
npm run start:http   # åç«¯ HTTP API (ç«¯å£ 3000)
cd web && npm run dev  # å‰ç«¯ Vite (ç«¯å£ 5173)

# å…¶ä»–å‘½ä»¤
npm run dev          # TypeScript ç›‘è§†æ¨¡å¼
npm run build:all    # æ„å»ºåç«¯ + å‰ç«¯
npm test             # è¿è¡Œæµ‹è¯•
```

**è®¿é—®åœ°å€ï¼š**
- Web ç•Œé¢ï¼šhttp://localhost:5173
- API æœåŠ¡ï¼šhttp://localhost:3000

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ index.ts           # MCP Server å…¥å£
â”œâ”€â”€ types/             # ç±»å‹å®šä¹‰
â”œâ”€â”€ storage/           # å­˜å‚¨å±‚
â”œâ”€â”€ services/          # ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ tools/             # MCP Tools
â”œâ”€â”€ prompts/           # AI æŒ‡å—
â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
```