---
id: verification_strategy
name: 验证策略
description: 设计测试用例和验收步骤，确保需求和设计得到有效验证
type: summary
acceptanceCriteria:
  - when: 验证策略设计完成
    then: 包含测试用例列表和验收步骤文档
  - when: 测试用例输出
    then: 覆盖正常流程、边界条件、异常情况
  - when: 验收步骤输出
    then: 可复现的验证操作序列
---

# 验证策略 (Verification Strategy)

**核心思维**：检验 (Verify)
**典型动作**：设计测试用例、验收步骤

## 执行步骤 (SOP)

### 1. 识别验证点
- 从需求和验收标准提取关键验证项
- 识别功能验证点（功能是否正常工作）
- 识别非功能验证点（性能、安全、兼容性）
- 确定验证优先级（P0/P1/P2）

### 2. 设计测试用例
- **正常流程**：验证核心功能在正常条件下的表现
- **边界条件**：验证临界值、极限值的处理
- **异常情况**：验证错误处理、容错能力
- 使用 Given/When/Then 格式编写用例

### 3. 确定验证方法
根据验证目标选择合适的验证方式：
- **单元测试**：验证单个函数/类的行为
- **集成测试**：验证模块间协作
- **端到端测试**：验证完整业务流程
- **手动验证**：验证UI交互、用户体验

### 4. 编写验收步骤
- 提供可复现的验证操作序列
- 明确每一步的预期结果
- 包含前置条件准备
- 包含验证后的清理工作

## 检查清单

### 验证点识别
- [ ] **功能验证点**：所有功能需求都有对应验证项？
- [ ] **非功能验证点**：性能、安全、兼容性等都覆盖？
- [ ] **验收标准映射**：每个验收标准都有测试用例？
- [ ] **优先级划分**：验证点按优先级分类（P0/P1/P2）？

### 测试用例设计
- [ ] **正常流程覆盖**：核心功能的正常使用场景都覆盖？
- [ ] **边界条件覆盖**：最小值、最大值、空值都测试？
- [ ] **异常情况覆盖**：错误输入、系统异常都处理？
- [ ] **用例格式规范**：使用 Given/When/Then 格式？

### 验证方法选择
- [ ] **测试层级合理**：单元/集成/E2E 分层合理？
- [ ] **工具选择明确**：测试框架和工具已确定？
- [ ] **自动化程度**：明确哪些可自动化、哪些需手动？
- [ ] **覆盖率目标**：设定合理的代码覆盖率目标？

### 验收步骤完整性
- [ ] **操作步骤清晰**：每一步都可执行？
- [ ] **预期结果明确**：每一步的预期结果都可验证？
- [ ] **前置条件完整**：验证前需要的准备工作都说明？
- [ ] **清理工作说明**：验证后的清理步骤都包含？

## 输出模板

```markdown
## 验证策略

### 验证目标
- [从需求和验收标准中提取的验证目标]

### 验证方法
- **单元测试**：[覆盖范围、工具选择]
- **集成测试**：[覆盖范围、工具选择]
- **E2E 测试**：[覆盖范围、工具选择]
- **手动验证**：[验证场景]

### 测试工具
- 测试框架：[Jest/Mocha/pytest/...]
- Mock 工具：[工具名称]
- 覆盖率工具：[工具名称]

### 覆盖目标
- 单元测试覆盖率：[目标百分比]
- 关键接口覆盖：[接口列表]
- 核心流程覆盖：[流程列表]

## 测试用例列表

### 功能模块：[模块名称]

#### TC01: [用例标题] (P0)
**描述**：[用例描述]

**前置条件**：
- [条件1]
- [条件2]

**测试步骤**：
```gherkin
Given [前置条件]
When [操作步骤]
Then [预期结果]
```

**测试数据**：
- 输入：[测试输入]
- 预期输出：[预期输出]

**验证方法**：[单元测试/集成测试/E2E测试/手动验证]

#### TC02: [边界条件测试] (P1)
[同上结构]

#### TC03: [异常情况测试] (P1)
[同上结构]

## 验收步骤

### 验收准备
1. [准备测试环境]
2. [准备测试数据]
3. [配置必要的依赖]

### 验收流程

#### Step 1: [验收项目1]
**操作**：
1. [操作步骤1]
2. [操作步骤2]

**预期结果**：
- [预期结果1]
- [预期结果2]

**验证方式**：[运行测试/检查输出/手动验证]

#### Step 2: [验收项目2]
[同上结构]

### 验收完成
1. [清理测试数据]
2. [恢复环境配置]
3. [记录验收结果]

## 测试用例示例

### 单元测试示例
\`\`\`typescript
describe('功能模块', () => {
  test('TC01: 正常场景', () => {
    // Given
    const input = {...};

    // When
    const result = functionUnderTest(input);

    // Then
    expect(result).toEqual(expected);
  });

  test('TC02: 边界条件', () => {
    // Given
    const edgeCaseInput = {...};

    // When
    const result = functionUnderTest(edgeCaseInput);

    // Then
    expect(result).toEqual(expectedEdgeCase);
  });

  test('TC03: 异常情况', () => {
    // Given
    const invalidInput = {...};

    // When & Then
    expect(() => functionUnderTest(invalidInput))
      .toThrow('错误信息');
  });
});
\`\`\`

### 集成测试示例
\`\`\`typescript
describe('模块集成', () => {
  test('TC04: 模块间协作', async () => {
    // Given
    const moduleA = new ModuleA();
    const moduleB = new ModuleB(moduleA);

    // When
    const result = await moduleB.processWithA(input);

    // Then
    expect(result).toMatchObject(expected);
    expect(moduleA.state).toBe('expected_state');
  });
});
\`\`\`

### E2E 测试示例
\`\`\`typescript
test('TC05: 完整业务流程', async ({ page }) => {
  // Given - 准备初始状态
  await page.goto('/start-page');

  // When - 执行业务操作
  await page.fill('[name="input-field"]', 'test-value');
  await page.click('button[type="submit"]');

  // Then - 验证最终状态
  await expect(page).toHaveURL('/result-page');
  await expect(page.locator('.result')).toContainText('expected-text');
});
\`\`\`

## 覆盖范围检查表

### 功能覆盖
| 功能点 | 测试用例 | 覆盖状态 | 优先级 |
|--------|----------|----------|--------|
| [功能1] | TC01, TC02 | ✅ | P0 |
| [功能2] | TC03 | ✅ | P1 |
| [功能3] | TC04 | ⏳ | P2 |

### 边界条件覆盖
- [ ] 最小值/最大值
- [ ] 空值/null/undefined
- [ ] 特殊字符/转义字符
- [ ] 超长输入
- [ ] 数据类型边界

### 异常情况覆盖
- [ ] 无效参数
- [ ] 网络异常/超时
- [ ] 权限不足
- [ ] 资源不足
- [ ] 并发冲突

### 非功能性验证
- [ ] 性能指标（响应时间、吞吐量）
- [ ] 安全性（权限、加密、注入防护）
- [ ] 兼容性（浏览器、版本、平台）
- [ ] 可用性（UI交互、用户体验）
```

## 验证规则

### 完整性验证
- 至少覆盖所有验收标准中的 THEN 条件
- 测试用例数量与功能复杂度匹配（简单功能≥5个，复杂功能≥10个）
- 包含正常流程、边界条件、异常情况三类用例
- 验收步骤可操作、可验证

### 可执行性验证
- 每个测试用例都有明确的 Given/When/Then
- 预期结果可量化、可观察
- 前置条件可准备
- 测试工具和框架已确定

### 覆盖范围验证
- 功能覆盖率 100%（所有功能点都有用例）
- 关键边界都有测试
- 主要异常都有覆盖
- P0 功能必须有自动化测试

### 完成标准
- 验证策略明确（验证方法、工具、覆盖目标）
- 测试用例列表完整（包含描述、步骤、预期结果）
- 验收步骤可执行（包含准备、执行、清理）
- 覆盖范围检查通过（功能、边界、异常都覆盖）

## 常见验证场景

### Feature 场景
- 功能正确性验证
- UI交互验证
- 集成验证
- 兼容性验证

### Debug 场景
- 修复验证（Bug不再复现）
- 回归验证（现有功能未受影响）
- 边界验证（相似场景也修复）

### Optimize 场景
- 性能指标验证（对比优化前后数据）
- 功能回归验证（优化未破坏功能）
- 资源消耗验证（CPU、内存、网络）

### Summary 场景
- 文档完整性验证
- 示例代码可运行性验证
- 链接有效性验证
